var CGI={ENV:"DEV",SET:{PUBLIC:{COACH_TYPE:"public/coach/types",COACH_LIST:"public/coach/list",COACH_DETAIL:"public/coach/detail",JOB_LIST:"public/job/list",JOB_DETAIL:"public/job/detail"},TYPE:{DEV:"get",TEST:"post",PUB:"post"},ROOT:{DEV:"/assets/json/",TEST:"http://localhost/",PUB:"/server/api/"}},TYPE:function(){var e=CGI.SET.TYPE[CGI.ENV]||"post";return e},URL:function(e,t){var n="?t="+(new Date).getTime();return"PUB"==CGI.ENV&&(n=".php?t="+(new Date).getTime()),CGI.SET.ROOT[CGI.ENV]+CGI.SET[e][t]+n},ajax:function(e,t,n){var i=CGI.TYPE();$.ajax({url:e,type:i,dataType:"json",data:t,success:function(e){n(e)}})},ajaxModule:function(e,t,n){var i=CGI.TYPE();$.ajax({url:e,type:i,async:!1,dataType:"json",data:t,success:function(e){n(e)}})},getView:function(e){var t="views/"+e+".html";$.ajax({url:t,type:"get",async:!1,dataType:"html",success:function(e){$("#app").html(e),Zen.init()},error:function(e){window.location.hash="index"}})}},Check={name:function(e){var t=/^\s*[\u4e00-\u9fa5]{1,}[\u4e00-\u9fa5.·]{0,15}[\u4e00-\u9fa5]{1,}\s*$/;return!!t.exec(e)},idCard:function(e){return IDCard.check(e)},number:function(e){if(0==e.length)return!1;if(6!=e.length)return!1;var t=/^\s*\d+\s*$/;return!!t.exec(e)},phone:function(e){return 0!=e.length&&(11==e.length&&!!/^1[3|4|5|7|8][0-9]\d{4,8}$/.test(e))},password:function(e){return 0!=e.length&&!(e.length<6||e.length>16)},code:function(e){return 0!=e.length&&6==e.length},bankcard:function(e){if(e.length<8||e.length>19)return!1;var t=/^\d*$/;return!!t.exec(e)},agreement:function(){if($(".agreement").length)return!!$(".agreement").hasClass("selected")||(Message.toast("您需要阅读并同意《用户协议》"),!1)}},Message={};Message.close=function(){$(".c-confirm").hide(300),$(".c-alert").hide(300),$(".c-select").hide(300),$(".c-dropdown").hide(300),$(".custom-confirm").hide(300)};var PageService={isLogin:!1,key:null,init:function(){Util._date(),this.ready()},ready:function(){$(document).ready(function(){PageService.bind(),PageService.loadView()})},loadView:function(){var e=Util.getHash()||"index";CGI.getView(e),$(window).on("hashchange",function(){var e=Util.getHash();CGI.getView(e)})},bind:function(){$("*[v-insert]").each(function(){var e=$(this),t=$(this).attr("v-insert");if(t){var n=t+".html";$.ajax({url:n,type:"get",async:!1,dataType:"html",success:function(t){e.html(t)}})}}),$("*[v-slot]").each(function(){var e=$(this),t=$(this).attr("v-slot");t&&e.html($("#"+t))}),$("*[v-send]").click(function(){var e=$(this).attr("v-send");if(e){var t=e.split(",");Message.send(t[0],t[1],t[2])}}),$("*[v-select]").click(function(){var e=$(this).attr("v-select");e&&Message.select("",e)}),$("*[v-toggle]").click(function(){var e=$(this).attr("v-toggle");e&&($("#"+e).toggle(),$(this).toggleClass("selected"))}),$("*[v-link]").click(function(){var e=$(this).attr("v-link");e&&(window.location.href=e)})},hideNavMenu:function(){$("#nav-menu").hide()},setTitle:function(e){$(".c-navmenu-banner .title").text(e)},status:function(){var e=CGI.URL("USER","STATUS");CGI.ajaxModule(e,"",function(e){e&&"00000"==e.code?PageService.isLogin=!0:PageService.isLogin=!1,PageService.key=e})},mustLogin:function(e){var t=CGI.URL("USER","STATUS");CGI.ajaxModule(t,"",function(t){if(t&&"50000"==t.code)return e?Store.sLocal("VIA",e):Store.sLocal("VIA",window.location.href),window.location.href="/user/login.html",!1})},token:function(){var e=CGI.URL("FRONT","TOKEN_GET");CGI.ajaxModule(e,"",function(e){e&&"00000"!=e.code&&Message.toast(e.message)})},loginAction:function(e,t){var n=CGI.URL("USER","STATUS");CGI.ajax(n,"",function(n){n&&"00000"==n.code?e&&e():t&&t()})},logout:function(){var e=CGI.URL("USER","LOGOUT");CGI.ajax(e,"",function(e){e&&"00000"==e.code&&(window.location.href="/index.html")})}},PageTips={tips:null,page:null,init:function(e){this.tips=$(".c-page-tips"),this.tips.show(),this.page=e,PageTips.rend(),setInterval(function(){PageTips.rend()},1e3)},list:function(){var e=this.tips,t=this.page,n="当前加载"+t.current_page+"/"+t.page_count+"页，共"+t.item_count+"条数据";e.find(".text").text(n),e.attr("data-status","enable")},loading:function(){var e=this.tips;e.find(".text").text("数据加载中……"),e.attr("data-status","disable")},none:function(){var e=this.tips;e.find(".text").text("当前暂无记录"),e.attr("data-status","disable")},end:function(){var e=this.tips;e.find(".text").text("当前数据已经加载完成"),e.attr("data-status","disable")},rend:function(e){var e=this.page;return this.loading(),e?e&&0==e.item_count?void this.none():e&&e.current_page==e.page_count?void this.end():e&&e.current_page<e.page_count?void this.list():void this.loading():void this.none()}},Store={data:function(e,t){if(!t){var n=e.data("data");return n}"string"==typeof t?e.data("data",t):e.data("data",JSON.stringify(t))},gData:function(e){var t=window.sessionStorage.getItem(e);return null==t||""==t?null:t=JSON.parse(window.sessionStorage.getItem(e))},sData:function(e,t){window.sessionStorage.setItem(e,JSON.stringify(t))},sValue:function(e,t){window.sessionStorage.setItem(e,t)},gValue:function(e){var t=window.sessionStorage.getItem(e);return t},sLocal:function(e,t){localStorage.setItem(e,t)},gLocal:function(e){var t=localStorage.getItem(e);return t},setLocal:function(e,t){localStorage.setItem(e,JSON.stringify(t))},getLocal:function(e){var t=localStorage.getItem(e);if(null==t||""==t)return null;try{return t=JSON.parse(localStorage.getItem(e))}catch(e){console.log(e)}return null},dLocal:function(e){localStorage.removeItem(e)},sHref:function(e){e?window.sessionStorage.setItem("redirect_url",e):window.sessionStorage.setItem("redirect_url",window.location.href)},goHref:function(){var e=window.sessionStorage.getItem("redirect_url");null!=e&&""!=e||(e="/"),window.location.href=e},gHref:function(){var e=window.sessionStorage.getItem("redirect_url");return null!=e&&""!=e||(e="/"),e}},User={key:null,isLogin:!1,need_verify_code:!1,baseinfo:null,spread_code:null,init:function(){return User.getKey(),User.isLogin=PageService.isLogin,this},getKey:function(){var e=PageService.key.modulus,t=PageService.key.public_exponent;if(void 0!=t){var n=RSAUtils.getKeyPair(t,"",e);console.log(n),User.key=n,User.need_verify_code=PageService.key.need_verify_code}},getBaseInfo:function(){if(PageService.isLogin){var e=CGI.URL("USER","BASE_INFO");CGI.ajaxModule(e,"",function(e){e&&"00000"==e.code&&(User.baseinfo=e.result)})}},getSpreadCode:function(){if(PageService.isLogin){var e=CGI.URL("USER","SPREAD_CODE");CGI.ajaxModule(e,"",function(e){e&&"00000"==e.code&&(User.spread_code=e.result.spread_code)})}},checkIdentity:function(){return User.getBaseInfo(),Identity.init(),"BTG"==Identity.status?void(window.location.href="/bid/identity.html?return_url="+window.location.href):void(User.baseinfo&&$(".user-account").text(User.baseinfo.balance))},checkBankcard:function(){BankCard.getBind(),BankCard.card?($(".methods-field").show(),$(".identity-field").hide()):($(".methods-field").hide(),$(".identity-field").show(),BankCard.init())},isIdentity:function(e){if(User.isLogin){var t=CGI.URL("PAY","GET_ID_CARD");CGI.ajaxModule(t,"",function(t){"00000"==t.code&&("TG"==t.result.status?e&&e():Message.alert("为了您的资金安全，您需要实名认证。",function(){window.location.href="/pay/wxidentity.html"}))})}},initPicCode:function(){if(User.need_verify_code){$(".pic-code").show();var e=$(".pic-code .code-img");e.attr("src","/userx/get_verify_code?"+Math.random()+"&verify_type=login")}else $(".pic-code").hide()},loginData:function(){var e={};if(User.key){var t=User.key;return e="none"==$(".pic-code").css("display")?{username:RSAUtils.encryptedString(t,$(".username").val()),password:RSAUtils.encryptedString(t,$(".password").val())}:{username:RSAUtils.encryptedString(t,$(".username").val()),password:RSAUtils.encryptedString(t,$(".password").val()),verify_code:$("input[name='piccode']").val()}}Message.alert("您的信息有误，请重新登录！")},login:function(e){var t=CGI.URL("USER","LOGIN");CGI.ajax(t,e,function(e){if("00000"==e.code){var t=Util.getPar("return_url")||Store.gLocal("VIA");t?window.location.href=t:window.location.href="/index.html"}else!e||"50008"!=e.code&&"50002"!=e.code&&"50012"!=e.code?(User.initPicCode(),Message.toast(e.message)):(User.need_verify_code=!0,User.initPicCode(),Message.toast(e.message))})},registData:function(){var e={};if(User.key){var t=User.key;return e={username:RSAUtils.encryptedString(t,$(".username").val()),password:RSAUtils.encryptedString(t,$(".password").val()),verify_code:$("input[name='verify_code']").val(),invitation_code:$("input[name='invitation_code']").val()}}Message.alert("您的信息有误，请重新注册！")},regist:function(e){var t=CGI.URL("USER","REGIST");CGI.ajax(t,e,function(e){if("00000"==e.code)window.location.href="/index.html?type=newuser";else if(e&&"50000"==e.code){var t=window.location.pathname+window.location.search;window.location.href="/user/login.html?return_url="+t}else Message.alert(e.message)})},changeData:function(){var e={};if(User.key){var t=User.key;return e={old_password:RSAUtils.encryptedString(t,$("input[name='password']").val()),new_password:RSAUtils.encryptedString(t,$("input[name='new_password']").val())}}Message.alert("您的信息有误，请重新输入！")},resetData:function(){var e={};if(User.key){var t=User.key;return e={verify_code:$("input[name='verify_code']").val(),password:RSAUtils.encryptedString(t,$("input[name='new_password']").val())}}Message.alert("您的信息有误，请重新输入！")},resetPassword:function(e){var t=CGI.URL("USER","RESET_PASSWORD");CGI.ajax(t,e,function(e){"00000"==e.code?Message.alert("密码找回成功,请用新密码登录",function(){window.location.href="/user/login.html"}):Message.alert(e.message)})},changePassword:function(e){var t=CGI.URL("USER","CHANGE_PASSWORD");CGI.ajax(t,e,function(e){"00000"==e.code?Message.alert("密码修改成功,请用新密码登录",function(){window.location.href="/user/login.html"}):Message.alert(e.message)})}},Util={lastClick:null,once:function(e){var t=(new Date).getTime();return t-Util.lastClick<2e3?void Message.toast("您的操作过快，请稍后尝试"):(Util.lastClick=t,void(e&&e()))},join:function(e,t,n){if(t instanceof Array)for(var i=0,a=t.length;i<a;i++)Util.join(e,t[i],n);for(var i in t)!n&&i in e||(e[i]=t[i]);return e},_date:function(){Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Date.parseJsonDate=function(e){if("[object Date]"==Object.prototype.toString.call(e))return e;var t=/\((\d+)\)/;return t.test(e)?new Date(t.exec(e)[1]-0):utlis.servertime()}},dateFull:function(e){return new Date(e).format("yyyy年MM月dd日 hh:mm")},dateStr:function(e){return new Date(e).format("yyyy-MM-dd hh:mm")},dateShort:function(e){return new Date(e).format("hh:mm:ss")},dateDot:function(e){return new Date(e).format("yyyy.MM.dd")},date:function(e){return new Date(e).format("yyyy-MM-dd")},_resize:function(){(window.innerWidth||document.body&&document.body.clientWidth)/320;$("html").css("font-size","62.5%")},resize:function(){Util._resize(),$(window).resize(function(){Util._resize()})},min:function(e,t){return e<t?e:t},check:function(e){return"undefined"==typeof e||null==e||""==e},getPar:function(e){var t=document.location.href,n=t.indexOf(e+"=");if(n==-1)return!1;var i=t.slice(e.length+n+1),a=i.indexOf("&");return a!=-1&&(i=i.slice(0,a)),i},getHash:function(){var e=window.location.hash.replace("#","");return e},isMobile:function(){var e={win:!1,mac:!1,xll:!1},t=navigator.platform;return e.win=0==t.indexOf("Win"),e.mac=0==t.indexOf("Mac"),e.x11="X11"==t||0==t.indexOf("Linux"),!(e.win||e.mac||e.xll)},trim:function(e,t){var n;return n=e.replace(/(^\s+)|(\s+$)/g,""),"g"==t.toLowerCase()&&(n=n.replace(/\s/g,"")),n},fmoney:function(e,n){(n<0||n>20)&&(n=2),e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(n)+"";var a=e.split(".")[0].split("").reverse(),o=e.split(".")[1];for(t="",len=a.length,"-"==a[len-1]&&(len-=1),i=0;i<len;i++)t+=a[i]+((i+1)%3==0&&i+1!=len?",":"");return"-"==a[len]&&(t+="-"),0==n?t.split("").reverse().join(""):t.split("").reverse().join("")+"."+o},fixMoney:function(e){return e=""==e||isNaN(e)||e==1/0?parseFloat("0").toFixed(2):parseFloat(e).toFixed(2)},getTimes:function(e,t){var n="";if($("#"+e).length&&$("#"+t).length){var i=$("#"+e).val().replace(/\//g,""),a=$("#"+t).val().replace(/\//g,"");n=i?i+"-":"-",a?n+=a:a=""}return n},rendSelect:function(e,t){var n=e[t];if($("select[name="+t+"]").length)for(var i in n)$("select[name="+t+"]").append('<option value="'+i+'">'+n[i]+"</option>")},rendValue:function(e,t){for(var n in t)n.indexOf("times")==-1&&n.indexOf("time")>-1?e.find("."+n).text(Util.dateStr(t[n])):n.indexOf("date")>-1?e.find("."+n).text(Util.date(t[n])):e.find("."+n).text(t[n])},getCommonPart:function(e,t){$.ajax({url:e,type:"get",async:!1,dataType:"html",success:function(e){$(t).html(e)}})},fmoney:function(e,n){(n<0||n>20)&&(n=2),e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(n)+"";var a=e.split(".")[0].split("").reverse(),o=e.split(".")[1];for(t="",i=0;i<a.length;i++)t+=a[i]+((i+1)%3==0&&i+1!=a.length?",":"");return 0==n?t.split("").reverse().join(""):t.split("").reverse().join("")+"."+o},scrollShow:function(e){$(window).scroll(function(){window.scrollY>200?$(e).show(300):$(e).hide()})},alertOver:function(){Message.alert("当前活动已经结束，请关注盈火虫公众号参与更多活动！",function(){window.location.href="/"})}},Zen={list:[],init:function(){var e=$("head");e.find("*[data-type='page-script']").remove();var t=$("<script>").attr("type","text/javascript"),n=$("#app");this.load(n);var i=$("*[v-script]").eq(0),a=i.attr("v-script");i.length>0&&a&&(t.attr("src",a),t.attr("data-type","page-script"),e.append(t))},load:function(e){e.find("*[v-zen]").each(function(){var e=$(this),t=$(this).attr("v-zen");if(t){var n=$(".zen-template .c-"+t).clone();e.html(n)}})},ready:function(e){e&&e.init&&e.init(),delete Zen.current,Zen.current=e}};PageService.init(),Message.alert=function(e,t){var n=$(".c-alert");$(".c-alert .message-text").html(e),n.show(300),$(".c-alert .alert-ok").unbind("click").click(function(){t&&t(),Message.close()})},Message.confirm=function(e,t){var n=$(".c-confirm");$(".c-confirm .message-text").html(e),n.show(300),$(".c-confirm .confirm-ok").unbind("click").click(function(){t&&t(),Message.close()}),$(".c-confirm .confirm-cancel").unbind("click").click(function(){Message.close()}),$(".c-confirm .mask").unbind("click").click(function(){Message.close()})};var Message1={toast:function(e){var t=$(".c-toast");$(".c-toast .message-text").text(e),t.show(300),setTimeout(function(){$(".c-toast").hide(500)},2e3)},alert:function(e,t){var n=$(".c-alert");$(".c-alert .message-text").html(e),n.show(300),$(".c-alert .alert-ok").unbind("click").click(function(){t&&t(),Message.close()})},confirm:function(e,t){var n=$(".c-confirm");$(".c-confirm .message-text").html(e),n.show(300),$(".c-confirm .confirm-ok").unbind("click").click(function(){t&&t(),Message.close()}),$(".c-confirm .confirm-cancel").unbind("click").click(function(){Message.close()}),$(".c-confirm .mask").unbind("click").click(function(){Message.close()})},custom:function(e){var t=$("#"+e);t.show(300),$(".custom-confirm .confirm-cancel").unbind("click").click(function(){Message.close()}),$(".custom-confirm .mask").unbind("click").click(function(){Message.close()})},select:function(e,t,n){var i=$("#"+t);i.find(".header-div .title").text(e),i.show(300),$(".c-select .select-ok").unbind("click").click(function(){n&&n(),Message.close()}),$(".c-select .mask").unbind("click").click(function(){Message.close()})},dropdown:function(e){var t=$("#"+e);t.show(300),$(".c-dropdown .dropdown-btn").unbind("click").click(function(){Message.close()}),$(".c-dropdown .mask").unbind("click").click(function(){Message.close()})},close:function(){$(".c-confirm").hide(300),$(".c-alert").hide(300),$(".c-select").hide(300),$(".c-dropdown").hide(300),$(".custom-confirm").hide(300)},send:function(verify_type,send_type,fn){if(fn){var fun=eval(fn);if(!fun())return}var sms=$(".sms-btn"),voice=$(".voice-btn");if(!sms.hasClass("gray")&&!voice.hasClass("gray")){var url=CGI.URL("USER","R_VERIFY_CODE");$.ajax({url:url,dataType:"json",beforeSend:function(){sms.addClass("gray"),voice.addClass("gray")},data:{phone:$("input[name='phone']").val(),verify_type:verify_type,send_type:send_type},success:function(e){"00000"==e.code?Message.nextClick(60,send_type):"50025"==e.code||"50027"==e.code?Message.nextClick(e.result.time_left,send_type):(Message.alert(e.message),$(".custom-confirm .error-message").text(e.message).removeClass("hide"),voice.removeClass("gray"),sms.removeClass("gray").text("获取验证码"),voice.text("收不到短信?试试语音验证"),wait=60)}})}},nextClick:function(e,t){var n=$(".sms-btn"),i=$(".voice-btn");0==e?(i.removeClass("gray"),n.removeClass("gray").text("获取验证码"),i.text("收不到短信?试试语音验证"),e=60):(n.hasClass("gray")||n.addClass("gray"),i.hasClass("gray")||i.addClass("gray"),n.text(e+"秒重获"),"voice"==t?i.text("请注意接听随机电话号码的语音验证码"):i.text("请等候"+e+"秒后再试试语音验证"),e--,setTimeout(function(){Message.nextClick(e,t)},1e3))}},MultiSelect=function(e){return e&&e.ele&&e.data&&(this.ele=$("#"+e.ele),this.data=e.data,this.para="",this.rend(e.data),this.bind()),this};MultiSelect.prototype={rend:function(e){for(var t=this,n=t.ele.find(".select-list"),i=0;i<e.length;i++){var a=e[i],o=$("<div>").addClass("select-item");Store.data(o,a),o.attr("data-value",a.value).text(a.name),n.append(o)}},bind:function(){var e=this;this.ele.find(".select-item").click(function(){var t=$(this);t.attr("data-value")?e.ele.find(".select-item").eq(0).removeClass("selected"):e.ele.find(".select-item").removeClass("selected"),t.toggleClass("selected"),e.rendValue()})},rendValue:function(){var e=this,t=e.ele.find(".select-list"),n="",i="";t.find(".selected").each(function(){var e=$(this);e.attr("data-value")&&(""==n?(n+=e.attr("data-value"),i+=e.text()):(n+=","+e.attr("data-value"),i+=","+e.text()))}),""==n&&(i="请选择"),e.ele.find(".select-area").text(i),e.ele.attr("data-value",n),e.para=n}},Message.toast=function(e){var t=$(".c-toast");$(".c-toast .message-text").text(e),t.show(300),setTimeout(function(){$(".c-toast").hide(500)},2e3)};var ToggleGroup=function(e){this.ele=$("#"+e.ele),this.data=e.data,this.para="",this.addAction=e.addAction,this.delAction=e.delAction,this.rend(e.data),this.bind()};ToggleGroup.prototype={rend:function(e){for(var t=this,n=t.ele,i=0;i<e.length;i++){var a=e[i],o=n.find(".template-area .toggle-item").clone();Store.data(o,a),o.text(a.name),a.selected?n.find("*[data-type='selected'] .toggle-list").append(o):n.find("*[data-type='none'] .toggle-list").append(o),t.bind(o)}},add:function(e){var t=this.ele,n=Store.data(e);t.find("*[data-type='selected'] .toggle-list").append(e),n.selected=!0,Store.data(e,n),this.addAction&&this.addAction(n)},del:function(e){var t=this.ele,n=Store.data(e);t.find("*[data-type='none'] .toggle-list").append(e),n.selected=!1,Store.data(e,n),this.addAction&&this.delAction(n)},bind:function(e){var t=this;e&&e.click(function(){var n=Store.data(e);n.selected?t.del(e):t.add(e)})}};